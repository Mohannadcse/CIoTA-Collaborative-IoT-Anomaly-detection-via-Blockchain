# CIoTA - Collaborative IoT Anomaly detection via Blockchain

## Overview
In this repository you will find a C++14 implementation of CIoTA; 
a lightweight framework that utilizes the blockchain concept to perform distributed and collaborative anomaly detection for devices with limited resources. 
From, Tomer Golomb, Yisroel Mirsky and Yuval Elovici.


## What is CIoTA?




The Internet of Things (IoT) is the next evolution of the Internet<cite>[1]</cite>. 
Leading IoT experts believe that by 2020 there will be more than 50 billion devices connected to the Internet which will offer a variety of applications and services for both daily and critical uses <cite>[2]</cite>.
The vision for these IoT devices is that they will autonomously communicate with one another to improve services and our daily lives.

Like any new architecture or technology, 
the IoT improves our lives but introduces disruptive elements as well. 
One known issue associated with IoT devices is that they tend to have vulnerabilities, 
which in some cases go unpatched by the manufacturer. 
An attacker can exploit these vulnerabilities for nefarious purposes<cite>[3]</cite>. 
Since IoT devices have been integrated into both daily and critical applications, 
their security is a significant concern.

One solution for protecting an IoT device is to install an intrusion detection system (IDS) <cite>[4]</cite>.
If the IDS is anomaly-based, the system has the potential to detect new and emerging threats that target the device.
However, there are two fundamental challenges with anomaly-based IDSs:

* **Adversarial Attacks** - During the training phase, all observations are considered benign and are used to train a model which captures the device's normal behavior. 
After the training phase, the model enters an execution phase where it is used to detect when newly observed behaviors deviate from the norm. 
Therefore, an attacker who exploits a device before the execution phase can evade detection entirely.

* **Model Sharing** - It is likely that false positives will occur if an anomaly detection model is trained on the observations of just a few devices. 
This is because some legitimate behaviors are rare and event-based, and therefore may not appear in the training data. 
For example, the motion detection logic of a smart camera or the response generated by a smoke detector sensing a fire.

However, consider the following scenario. 
Assume that all IoT devices of the same type simultaneously begin training their own anomaly detection model, 
based on their own locally observed behaviors. 
In this scenario, it is unlikely that the majority of these IoT devices would be exploited before the majority completes their training phases.

Using this underlying assumption, we present CIoTA (pronounced as _syota_): a lightweight, scalable framework which utilizes the blockchain concept to perform distributed and collaborative anomaly detection on resource limited devices, such as IoT devices. 


The blockchain is a protocol for maintaining a distributed ledger. The ledger is a chain of blocks which is collectively agreed upon by the majority of participants in the network <cite>[5]</cite>. Each block is accepted into the chain if it can achieve consensus represented as the satisfaction of specific criteria (e.g., the proof of work criterion in bitcoin <cite>[6]</cite>). In the context of a device from a specific model, CIoTA uses the blockchain protocol to collaborate among devices of the same type to create a trusted anomaly detection model. This is accomplished by merging locally trained models into a single global model. A block is a set of locally trained models from different devices. Each device validates the integrity of a block in progress by merging the models and by performing self- attestation. When the block reaches a size limit, it is closed and a new block begins. A closed block in the chain represents a model which has been validated by the majority of devices in the system, and is therefore ready to be used (executed on-site).
The anomaly detection model used by CIoTA is an exten- sible Markov model (EMM). The EMM tracks a programâ€™s regular memory jump sequences and can be incrementally updated and merged with other models. To introduce new benign concepts into the merged model, we accept new states to the EMM only when there is a consensus among the models.

To understand how CIoTA works lets explore the following analogy:
Let's assume that there is an agency called CIoTA which has many agents, each of which is in the enemy's territory. 
The mission of the agents is to (1) detect malicious acts, and (2) gather intel about what is happening and share a collection of intel (as rumors) with other agents. 
Since an agent is in the enemy's territory, the agent may receive false intel which introduces noise into the rumors conveyed to the other agents. 
Therefore, an agent will only trust a rumor (some intel) if that agent knows that at least Pc other agents have heard the same rumor. 
Finally, an agent accepts the most recent set of L trusted rumors as the latest description of the territory. 

This scenario is implemented in the CIoTA framework as follows. 
Each IoT device has an agent which maintains a local model ML that is used to detect malicious behaviors in a particular application. 
An agent records new intel by updating ML with observations on the application's behavior. 
An agent shares its Intel (ML), in the form of a rumor, by adding ML to the chain's _partial block_, 
and then sending the chain to neighboring agents in the network. 
Other agents will only accept this _partial block_ if it is longer than their _partial block_, 
and if they can attest that it is safe (by verifying it against their own local model). 
Thus, the _partial block_ only grows if the majority of agents have verified that it contains a safe model. 
Once the _partial block_ contains L reports, it is closed as a completed block. 
Therefore, an agent receives the latest intelligence from its fellow agents by replacing ML with the combined model contained within the newest closed block. 
Finally, to ensure that the rumors have indeed come from a specific agent, rumors are signed by a private key and verified with the respective public key. 

The following describes an agent's three parallel processes:

![Image](LLD3-1.png?raw=true)


# Using The Code
We will update CIoTA code soon; we apologize for the inconvenience.

